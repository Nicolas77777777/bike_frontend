<%- include('partials/header', { titolo: 'Iscrizione Cliente a Evento' }) %>

<!-- ✅ CORRETTO: Mantiene il contesto delle iscrizioni -->
<form method="GET" action="/iscrizioni" class="mb-3">
  <div class="row g-3 align-items-end">
    <div class="col-md-6">
      <label class="form-label">Ricerca evento per titolo</label>
      <input type="text" name="titolo" class="form-control" 
             placeholder="Inserisci parte del titolo" 
             value="<%= req.query.titolo || '' %>">
    </div>
    
    <!-- ✅ OPZIONALE: Aggiungi filtro categoria -->
    <div class="col-md-3">
      <label class="form-label">Categoria</label>
      <select name="categoria" class="form-select">
        <option value="">Tutte le categorie</option>
        <% if (typeof tipologiche !== 'undefined' && tipologiche && tipologiche.length > 0) { %>
          <% tipologiche.forEach(t => { %>
            <option value="<%= t.id_tipologica %>" 
                    <%= req.query.categoria == t.id_tipologica ? 'selected' : '' %>>
              <%= t.descrizione %>
            </option>
          <% }) %>
        <% } %>
      </select>
    </div>
    
    <div class="col-md-3 d-grid">
      <button type="submit" class="btn btn-primary">
        <i class="bi bi-search"></i> Cerca Eventi
      </button>
    </div>
  </div>
  
  <!-- ✅ OPZIONALE: Filtri avanzati -->
  <div class="row g-3 mt-2">
    <div class="col-md-4">
      <label class="form-label">Data inizio da:</label>
      <input type="date" name="data_inizio" class="form-control" 
             value="<%= req.query.data_inizio || '' %>">
    </div>
    <div class="col-md-4">
      <label class="form-label">Data fine fino:</label>
      <input type="date" name="data_fine" class="form-control" 
             value="<%= req.query.data_fine || '' %>">
    </div>
    <div class="col-md-4 d-grid align-self-end">
      <a href="/iscrizioni" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-clockwise"></i> Reset Filtri
      </a>
    </div>
  </div>
</form>